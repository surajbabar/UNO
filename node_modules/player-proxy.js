var proxy = {};
var playerModel = require('player.js').player;

var observer;

proxy.createProxy = function (socket, gameMaster) {
    observer = gameMaster;
    var proxyDetails = {player: "", channel: socket};
    socket.on('data',function(text){
        var data = JSON.parse(text);
        if(data.type == 'introduction'){
            var player = playerModel.createPlayer(data.playerName);
            observer.onPlayerRegistered(player);
        }
    });
    return proxyDetails;
}

proxy.send = function(playerProxy){
    playerProxy.channel.write('start');
}

exports.proxy = proxy;